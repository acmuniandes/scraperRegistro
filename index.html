
<html>
  <head>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.js" integrity="sha256-tA8y0XqiwnpwmOIl3SGAcFl2RvxHjA8qp0+1uCGmRmg=" crossorigin="anonymous"></script>
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

        <!-- Optional theme -->
         <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

        <!-- Latest compiled and minified JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
        <script src="https://unpkg.com/vue"></script>
    </head>

    <body>
        
        <div id='app'><!-- Contenedor de todo Vue -->

        {{arregloSalones}}

            <button v-on:click="cargarSalones()">
                Cargar Salones del JSON
            </button>

            <button v-on:click="formatClassrooms(buscarSalonesEdificio('ML'))">
                Cargar Salones ML
            </button>

            <button v-on:click="pruebaScriprt()">
                Script Python
            </button>

            <h2>
                    {{message}}
            </h2>

            

            <input>
            
            </input>

        </div>

        <script>
        
        var app = new Vue({
            el: '#app',
            data:{
                arregloSalones: {},
                jsonObject: '',
                message: ''
            },
            methods:{
                cargarSalones: function(){
                    let networkPromise = fetch('/UpdatedClassrooms.json');
                    networkPromise.then((rjson)=>{
                        let parsinPromise = rjson.json();
                        parsinPromise.then((rsalones)=>{
                            console.log(rsalones)
                            this.jsonObject = rsalones;
                            //this.arregloSalones = JSON.parse(rsalones); //Acá puedo llamarle a rSalones un atributo (objeto del JSON)
                        })
                   })
               },

               buscarSalonesEdificio: function(edificio)
               {
                   var salonesEdificio = []                
                   for (var idSalon in this.jsonObject)
                   {
                       if (idSalon.includes(edificio))
                       {
                            var horarioSalon = this.jsonObject[idSalon];
                            salonesEdificio.push([idSalon, horarioSalon]);
                       }
                       
                   }

                   console.log(salonesEdificio);

                   this.formatClassrooms(salonesEdificio);
               },

               formatClassrooms: function(arreglo)
               {
                   var respuesta = ''

                   console.log(typeof arreglo)

                   console.log(arreglo[0])

                   for (var j = 0; j < arreglo.length; j++)
                   {
                        respuesta += arreglo[j][0] + "\n";
                       for (dia in arreglo[j][i])
                       {
                           var i = 0;
                           for (horario in dia)
                           {
                               if (horario.length > 5)
                               {
                                   console.log("entre")
                                    respuesta += this.formatDay(i) + horario + "\n";
                                    i++;
                               }
                           }                           
                       }
                   }

                   console.log(respuesta);
                   this.message = respuesta;
               },

               formatDay: function(day)
               {
                   if (day == 0)
                   {
                       return "Lunes: ";
                   }
                   else if (day == 1)
                   {
                       return "Martes: ";
                   }
                   else if (day == 2)
                   {
                       return "Miércoles: ";
                   }
                   else if (day == 3)
                   {
                       return "Jueves: ";
                   }
                   else if (day == 4)
                   {
                       return "Viernes: ";
                   }
                   else if (day == 5)
                   {
                       return "Sábado: ";
                   }
                   else if (day == 6)
                   {
                       return "Domingo: ";
                   }
                   else
                   {
                        return "He fucked up";
                   }
               },

               pruebaScript: function(input)
               {
                    $.ajax({
                        type: "POST",
                        url: "/classroomsQuery.py",
                        data: { param: input },
                        success: console.log("WTF")
                    });
               }

            }
        })

        </script>
    </body>

</html>